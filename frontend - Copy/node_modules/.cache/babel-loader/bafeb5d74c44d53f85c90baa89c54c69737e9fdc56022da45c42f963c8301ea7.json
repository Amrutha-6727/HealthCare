{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arrur\\\\Downloads\\\\HealthCareApplication\\\\frontend\\\\src\\\\pages\\\\Appointments.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from 'react';\nimport { fetchAppointments, updateAppointment, fetchUser, fetchCoach, fetchAppointmentsByUser, fetchAppointmentsByCoach } from '../api';\nimport { AuthContext } from '../AuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Appointments() {\n  _s();\n  const [appointments, setAppointments] = useState([]);\n  const {\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    if (user && user.username && user.id) {\n      // determine role by presence of specialty (coach) or other heuristic\n      if (user.specialty) {\n        fetchAppointmentsByCoach(user.id).then(setAppointments).catch(() => setAppointments([]));\n      } else {\n        fetchAppointmentsByUser(user.id).then(setAppointments).catch(() => setAppointments([]));\n      }\n    } else {\n      fetchAppointments().then(setAppointments).catch(() => setAppointments([]));\n    }\n  }, [user]);\n  const [resolved, setResolved] = useState({});\n  useEffect(() => {\n    (async () => {\n      const users = {};\n      const coaches = {};\n      await Promise.all(appointments.map(async a => {\n        if (a.userId && !users[a.userId]) {\n          users[a.userId] = await fetchUser(a.userId).catch(() => ({\n            username: a.userId\n          }));\n        }\n        if (a.coachId && !coaches[a.coachId]) {\n          coaches[a.coachId] = await fetchCoach(a.coachId).catch(() => ({\n            username: a.coachId\n          }));\n        }\n      }));\n      setResolved({\n        users,\n        coaches\n      });\n    })();\n  }, [appointments]);\n  const takeAction = async (id, action, comment) => {\n    await updateAppointment(id, {\n      status: action,\n      coachComments: comment || (action === 'ACCEPTED' ? 'Accepted' : 'Rejected')\n    });\n    // refresh\n    if (user && user.specialty) fetchAppointmentsByCoach(user.id).then(setAppointments);else if (user) fetchAppointmentsByUser(user.id).then(setAppointments);else fetchAppointments().then(setAppointments);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 20\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Appointments\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), appointments.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"No appointments found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 35\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid',\n        gap: 12\n      },\n      children: appointments.map(a => {\n        var _resolved$users$a$use, _resolved$coaches$a$c;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            border: '1px solid #eee',\n            padding: 12,\n            borderRadius: 6\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 700\n                },\n                children: [\"#\", a.id, \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    marginLeft: 8,\n                    color: '#666'\n                  },\n                  children: a.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 55,\n                  columnNumber: 55\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 55,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [\"User: \", resolved.users && ((_resolved$users$a$use = resolved.users[a.userId]) === null || _resolved$users$a$use === void 0 ? void 0 : _resolved$users$a$use.username) || a.userId]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 56,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [\"Coach: \", resolved.coaches && ((_resolved$coaches$a$c = resolved.coaches[a.coachId]) === null || _resolved$coaches$a$c === void 0 ? void 0 : _resolved$coaches$a$c.username) || a.coachId]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [\"Date: \", a.appointmentDate, \" Slot: \", a.slot]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 58,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 54,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: a.status === 'PENDING' && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => takeAction(a.id, 'ACCEPTED'),\n                  style: {\n                    marginRight: 8\n                  },\n                  children: \"Accept\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 63,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => takeAction(a.id, 'REJECTED'),\n                  children: \"Reject\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 64,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 13\n          }, this)\n        }, a.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n_s(Appointments, \"EQhStLVjZvP8HmAenYqLMS8hJyE=\");\n_c = Appointments;\nvar _c;\n$RefreshReg$(_c, \"Appointments\");","map":{"version":3,"names":["React","useEffect","useState","useContext","fetchAppointments","updateAppointment","fetchUser","fetchCoach","fetchAppointmentsByUser","fetchAppointmentsByCoach","AuthContext","jsxDEV","_jsxDEV","Fragment","_Fragment","Appointments","_s","appointments","setAppointments","user","username","id","specialty","then","catch","resolved","setResolved","users","coaches","Promise","all","map","a","userId","coachId","takeAction","action","comment","status","coachComments","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","length","display","gap","_resolved$users$a$use","_resolved$coaches$a$c","border","borderRadius","justifyContent","alignItems","fontWeight","marginLeft","color","appointmentDate","slot","onClick","marginRight","_c","$RefreshReg$"],"sources":["C:/Users/arrur/Downloads/HealthCareApplication/frontend/src/pages/Appointments.js"],"sourcesContent":["import React, {useEffect, useState, useContext} from 'react';\r\nimport { fetchAppointments, updateAppointment, fetchUser, fetchCoach, fetchAppointmentsByUser, fetchAppointmentsByCoach } from '../api';\r\nimport { AuthContext } from '../AuthContext';\r\n\r\nexport default function Appointments(){\r\n  const [appointments,setAppointments]=useState([]);\r\n  const { user } = useContext(AuthContext);\r\n  useEffect(()=>{\r\n    if(user && user.username && user.id){\r\n      // determine role by presence of specialty (coach) or other heuristic\r\n      if(user.specialty){\r\n        fetchAppointmentsByCoach(user.id).then(setAppointments).catch(()=>setAppointments([]));\r\n      } else {\r\n        fetchAppointmentsByUser(user.id).then(setAppointments).catch(()=>setAppointments([]));\r\n      }\r\n    } else {\r\n      fetchAppointments().then(setAppointments).catch(()=>setAppointments([]));\r\n    }\r\n  },[user]);\r\n  const [resolved, setResolved] = useState({});\r\n\r\n  useEffect(()=>{\r\n    (async ()=>{\r\n      const users = {};\r\n      const coaches = {};\r\n      await Promise.all(appointments.map(async (a)=>{\r\n        if(a.userId && !users[a.userId]){\r\n          users[a.userId] = await fetchUser(a.userId).catch(()=>({username:a.userId}));\r\n        }\r\n        if(a.coachId && !coaches[a.coachId]){\r\n          coaches[a.coachId] = await fetchCoach(a.coachId).catch(()=>({username:a.coachId}));\r\n        }\r\n      }));\r\n      setResolved({users, coaches});\r\n    })();\r\n  },[appointments]);\r\n\r\n  const takeAction = async (id, action, comment)=>{\r\n    await updateAppointment(id, {status: action, coachComments: comment || (action==='ACCEPTED'? 'Accepted':'Rejected')});\r\n    // refresh\r\n    if(user && user.specialty) fetchAppointmentsByCoach(user.id).then(setAppointments);\r\n    else if(user) fetchAppointmentsByUser(user.id).then(setAppointments);\r\n    else fetchAppointments().then(setAppointments);\r\n  }\r\n\r\n  return (\r\n    <div style={{padding:20}}>\r\n      <h2>Appointments</h2>\r\n      {appointments.length===0 && <div>No appointments found</div>}\r\n      <div style={{display:'grid', gap:12}}>\r\n        {appointments.map(a=> (\r\n          <div key={a.id} style={{border:'1px solid #eee', padding:12, borderRadius:6}}>\r\n            <div style={{display:'flex', justifyContent:'space-between', alignItems:'center'}}>\r\n              <div>\r\n                <div style={{fontWeight:700}}>#{a.id} <span style={{marginLeft:8, color:'#666'}}>{a.status}</span></div>\r\n                <div>User: {resolved.users && resolved.users[a.userId]?.username || a.userId}</div>\r\n                <div>Coach: {resolved.coaches && resolved.coaches[a.coachId]?.username || a.coachId}</div>\r\n                <div>Date: {a.appointmentDate} Slot: {a.slot}</div>\r\n              </div>\r\n              <div>\r\n                {a.status==='PENDING' && (\r\n                  <>\r\n                    <button onClick={()=>takeAction(a.id, 'ACCEPTED')} style={{marginRight:8}}>Accept</button>\r\n                    <button onClick={()=>takeAction(a.id, 'REJECTED')}>Reject</button>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,SAAS,EAAEC,QAAQ,EAAEC,UAAU,QAAO,OAAO;AAC5D,SAASC,iBAAiB,EAAEC,iBAAiB,EAAEC,SAAS,EAAEC,UAAU,EAAEC,uBAAuB,EAAEC,wBAAwB,QAAQ,QAAQ;AACvI,SAASC,WAAW,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE7C,eAAe,SAASC,YAAYA,CAAA,EAAE;EAAAC,EAAA;EACpC,MAAM,CAACC,YAAY,EAACC,eAAe,CAAC,GAAChB,QAAQ,CAAC,EAAE,CAAC;EACjD,MAAM;IAAEiB;EAAK,CAAC,GAAGhB,UAAU,CAACO,WAAW,CAAC;EACxCT,SAAS,CAAC,MAAI;IACZ,IAAGkB,IAAI,IAAIA,IAAI,CAACC,QAAQ,IAAID,IAAI,CAACE,EAAE,EAAC;MAClC;MACA,IAAGF,IAAI,CAACG,SAAS,EAAC;QAChBb,wBAAwB,CAACU,IAAI,CAACE,EAAE,CAAC,CAACE,IAAI,CAACL,eAAe,CAAC,CAACM,KAAK,CAAC,MAAIN,eAAe,CAAC,EAAE,CAAC,CAAC;MACxF,CAAC,MAAM;QACLV,uBAAuB,CAACW,IAAI,CAACE,EAAE,CAAC,CAACE,IAAI,CAACL,eAAe,CAAC,CAACM,KAAK,CAAC,MAAIN,eAAe,CAAC,EAAE,CAAC,CAAC;MACvF;IACF,CAAC,MAAM;MACLd,iBAAiB,CAAC,CAAC,CAACmB,IAAI,CAACL,eAAe,CAAC,CAACM,KAAK,CAAC,MAAIN,eAAe,CAAC,EAAE,CAAC,CAAC;IAC1E;EACF,CAAC,EAAC,CAACC,IAAI,CAAC,CAAC;EACT,MAAM,CAACM,QAAQ,EAAEC,WAAW,CAAC,GAAGxB,QAAQ,CAAC,CAAC,CAAC,CAAC;EAE5CD,SAAS,CAAC,MAAI;IACZ,CAAC,YAAU;MACT,MAAM0B,KAAK,GAAG,CAAC,CAAC;MAChB,MAAMC,OAAO,GAAG,CAAC,CAAC;MAClB,MAAMC,OAAO,CAACC,GAAG,CAACb,YAAY,CAACc,GAAG,CAAC,MAAOC,CAAC,IAAG;QAC5C,IAAGA,CAAC,CAACC,MAAM,IAAI,CAACN,KAAK,CAACK,CAAC,CAACC,MAAM,CAAC,EAAC;UAC9BN,KAAK,CAACK,CAAC,CAACC,MAAM,CAAC,GAAG,MAAM3B,SAAS,CAAC0B,CAAC,CAACC,MAAM,CAAC,CAACT,KAAK,CAAC,OAAK;YAACJ,QAAQ,EAACY,CAAC,CAACC;UAAM,CAAC,CAAC,CAAC;QAC9E;QACA,IAAGD,CAAC,CAACE,OAAO,IAAI,CAACN,OAAO,CAACI,CAAC,CAACE,OAAO,CAAC,EAAC;UAClCN,OAAO,CAACI,CAAC,CAACE,OAAO,CAAC,GAAG,MAAM3B,UAAU,CAACyB,CAAC,CAACE,OAAO,CAAC,CAACV,KAAK,CAAC,OAAK;YAACJ,QAAQ,EAACY,CAAC,CAACE;UAAO,CAAC,CAAC,CAAC;QACpF;MACF,CAAC,CAAC,CAAC;MACHR,WAAW,CAAC;QAACC,KAAK;QAAEC;MAAO,CAAC,CAAC;IAC/B,CAAC,EAAE,CAAC;EACN,CAAC,EAAC,CAACX,YAAY,CAAC,CAAC;EAEjB,MAAMkB,UAAU,GAAG,MAAAA,CAAOd,EAAE,EAAEe,MAAM,EAAEC,OAAO,KAAG;IAC9C,MAAMhC,iBAAiB,CAACgB,EAAE,EAAE;MAACiB,MAAM,EAAEF,MAAM;MAAEG,aAAa,EAAEF,OAAO,KAAKD,MAAM,KAAG,UAAU,GAAE,UAAU,GAAC,UAAU;IAAC,CAAC,CAAC;IACrH;IACA,IAAGjB,IAAI,IAAIA,IAAI,CAACG,SAAS,EAAEb,wBAAwB,CAACU,IAAI,CAACE,EAAE,CAAC,CAACE,IAAI,CAACL,eAAe,CAAC,CAAC,KAC9E,IAAGC,IAAI,EAAEX,uBAAuB,CAACW,IAAI,CAACE,EAAE,CAAC,CAACE,IAAI,CAACL,eAAe,CAAC,CAAC,KAChEd,iBAAiB,CAAC,CAAC,CAACmB,IAAI,CAACL,eAAe,CAAC;EAChD,CAAC;EAED,oBACEN,OAAA;IAAK4B,KAAK,EAAE;MAACC,OAAO,EAAC;IAAE,CAAE;IAAAC,QAAA,gBACvB9B,OAAA;MAAA8B,QAAA,EAAI;IAAY;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EACpB7B,YAAY,CAAC8B,MAAM,KAAG,CAAC,iBAAInC,OAAA;MAAA8B,QAAA,EAAK;IAAqB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,eAC5DlC,OAAA;MAAK4B,KAAK,EAAE;QAACQ,OAAO,EAAC,MAAM;QAAEC,GAAG,EAAC;MAAE,CAAE;MAAAP,QAAA,EAClCzB,YAAY,CAACc,GAAG,CAACC,CAAC;QAAA,IAAAkB,qBAAA,EAAAC,qBAAA;QAAA,oBACjBvC,OAAA;UAAgB4B,KAAK,EAAE;YAACY,MAAM,EAAC,gBAAgB;YAAEX,OAAO,EAAC,EAAE;YAAEY,YAAY,EAAC;UAAC,CAAE;UAAAX,QAAA,eAC3E9B,OAAA;YAAK4B,KAAK,EAAE;cAACQ,OAAO,EAAC,MAAM;cAAEM,cAAc,EAAC,eAAe;cAAEC,UAAU,EAAC;YAAQ,CAAE;YAAAb,QAAA,gBAChF9B,OAAA;cAAA8B,QAAA,gBACE9B,OAAA;gBAAK4B,KAAK,EAAE;kBAACgB,UAAU,EAAC;gBAAG,CAAE;gBAAAd,QAAA,GAAC,GAAC,EAACV,CAAC,CAACX,EAAE,EAAC,GAAC,eAAAT,OAAA;kBAAM4B,KAAK,EAAE;oBAACiB,UAAU,EAAC,CAAC;oBAAEC,KAAK,EAAC;kBAAM,CAAE;kBAAAhB,QAAA,EAAEV,CAAC,CAACM;gBAAM;kBAAAK,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACxGlC,OAAA;gBAAA8B,QAAA,GAAK,QAAM,EAACjB,QAAQ,CAACE,KAAK,MAAAuB,qBAAA,GAAIzB,QAAQ,CAACE,KAAK,CAACK,CAAC,CAACC,MAAM,CAAC,cAAAiB,qBAAA,uBAAxBA,qBAAA,CAA0B9B,QAAQ,KAAIY,CAAC,CAACC,MAAM;cAAA;gBAAAU,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnFlC,OAAA;gBAAA8B,QAAA,GAAK,SAAO,EAACjB,QAAQ,CAACG,OAAO,MAAAuB,qBAAA,GAAI1B,QAAQ,CAACG,OAAO,CAACI,CAAC,CAACE,OAAO,CAAC,cAAAiB,qBAAA,uBAA3BA,qBAAA,CAA6B/B,QAAQ,KAAIY,CAAC,CAACE,OAAO;cAAA;gBAAAS,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAC1FlC,OAAA;gBAAA8B,QAAA,GAAK,QAAM,EAACV,CAAC,CAAC2B,eAAe,EAAC,SAAO,EAAC3B,CAAC,CAAC4B,IAAI;cAAA;gBAAAjB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChD,CAAC,eACNlC,OAAA;cAAA8B,QAAA,EACGV,CAAC,CAACM,MAAM,KAAG,SAAS,iBACnB1B,OAAA,CAAAE,SAAA;gBAAA4B,QAAA,gBACE9B,OAAA;kBAAQiD,OAAO,EAAEA,CAAA,KAAI1B,UAAU,CAACH,CAAC,CAACX,EAAE,EAAE,UAAU,CAAE;kBAACmB,KAAK,EAAE;oBAACsB,WAAW,EAAC;kBAAC,CAAE;kBAAApB,QAAA,EAAC;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,eAC1FlC,OAAA;kBAAQiD,OAAO,EAAEA,CAAA,KAAI1B,UAAU,CAACH,CAAC,CAACX,EAAE,EAAE,UAAU,CAAE;kBAAAqB,QAAA,EAAC;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC;cAAA,eAClE;YACH;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC,GAhBEd,CAAC,CAACX,EAAE;UAAAsB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAiBT,CAAC;MAAA,CACP;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC9B,EAAA,CArEuBD,YAAY;AAAAgD,EAAA,GAAZhD,YAAY;AAAA,IAAAgD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}